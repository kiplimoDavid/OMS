{% extends "base.html" %}
{% block title %}Invoice #{{ order.order_number }}{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2><i class="bi bi-receipt me-2" aria-hidden="true"></i>Invoice</h2>
        <button onclick="window.print()" class="btn btn-outline-secondary d-print-none">
            <i class="bi bi-printer me-1"></i> Print
        </button>
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-body">
            <div class="row">
                <div class="col-md-6">
                    <h5>Bill To:</h5>
                    <p class="mb-1">{{ order.customer.name }}</p>
                    <p class="mb-1">{{ order.billing_address or "N/A" }}</p>
                    <p>Email: {{ order.customer.user.email }}</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <h5>Invoice Details</h5>
                    <p class="mb-1"><strong>Invoice #:</strong> {{ order.order_number }}</p>
                    <p class="mb-1"><strong>Date:</strong> {{ order.order_date.strftime('%Y-%m-%d') }}</p>
                    <p class="mb-1"><strong>Status:</strong> 
                        <span class="badge bg-{{ 'success' if order.payment_status.name == 'PAID' else 'danger' }}">
                            {{ order.payment_status.value }}
                        </span>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm mb-4">
        <div class="card-header bg-light"><strong>Order Summary</strong></div>
        <table class="table mb-0">
            <thead>
                <tr>
                    <th scope="col">Item</th>
                    <th scope="col" class="text-center">Qty</th>
                    <th scope="col" class="text-end">Unit Price</th>
                    <th scope="col" class="text-end">Subtotal</th>
                </tr>
            </thead>
            <tbody>
                {% for item in order.items %}
                <tr>
                    <td>{{ item.product.name }}</td>
                    <td class="text-center">{{ item.quantity }}</td>
                    <td class="text-end">{{ item.unit_price | format_currency }}</td>
                    <td class="text-end">{{ (item.unit_price * item.quantity) | format_currency }}</td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="3" class="text-end"><strong>Total:</strong></td>
                    <td class="text-end"><strong>{{ order.total_amount | format_currency }}</strong></td>
                </tr>
            </tfoot>
        </table>
    </div>

    <div class="text-muted small text-end">
        <p class="mb-0">Thank you for your purchase!</p>
        <p class="mb-0">This invoice was generated on {{ now().strftime('%B %d, %Y') }}</p>
    </div>
</div>
{% endblock %}
